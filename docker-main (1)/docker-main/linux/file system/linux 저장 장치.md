## 1. 리눅스 저장 장치 개요

리눅스에서 저장 장치는 **계층 구조**를 가지고 있으며, 다음과 같은 레벨로 나눌 수 있습니다:

```
[ 사용자 레벨: 파일 시스템, 마운트 포인트 ]
       ↓
[ 블록 레벨: 파티션, LVM, RAID ]
       ↓
[ 커널 I/O 스택: VFS, 페이지 캐시, 블록 계층 ]
       ↓
[ 디바이스 드라이버: SCSI, NVMe, AHCI ]
       ↓
[ 물리 디바이스: HDD, SSD, USB, NVMe ]
```

즉, **파일 시스템 → 블록 디바이스 → 물리 디바이스**의 3단 구조를 가집니다.

---

## 2. 저장 장치 명명 규칙

리눅스에서 주요 저장 장치 이름은 다음과 같이 구분됩니다.

| 디바이스      | 예시            | 설명                            |
| --------- | ------------- | ----------------------------- |
| SCSI/SATA | /dev/sd\[a-z] | 전통적 하드디스크, SSD, USB 저장장치      |
| NVMe      | /dev/nvme0n1  | NVMe SSD: 병렬 I/O 지원, 고성능 스토리지 |
| MMC/SD 카드 | /dev/mmcblk0  | SD 카드, eMMC 디바이스              |
| 루프백 디바이스  | /dev/loop0    | ISO 마운트, 디스크 이미지 가상 장치        |
| RAM 디스크   | /dev/ram0     | 메모리 기반 가상 블록 디바이스             |
| 플래시 디바이스  | /dev/mtd0     | NAND 플래시: 임베디드 시스템에서 사용       |
| CD/DVD    | /dev/sr0      | 광학 드라이브                       |

---

## 3. 블록 디바이스 계층

리눅스 저장 장치 관리는 \*\*블록 단위(Block Device)\*\*로 이루어집니다.
한 블록은 일반적으로 512B 또는 4KB 단위이며, 블록 디바이스 계층은 다음 역할을 담당합니다.

* **I/O 스케줄링**: 요청 병합, 순서 최적화 → 성능 향상
* **캐싱**: 페이지 캐시를 통한 읽기 성능 향상
* **멀티큐(blk-mq)**: 멀티코어 시스템에서 병렬 I/O 지원

---

## 4. 파일 시스템 계층

리눅스에서 사용되는 대표적인 파일 시스템:

* **ext4**: 가장 널리 사용되는 전통적 파일시스템
* **XFS**: 대용량, 고성능 지원
* **Btrfs**: 스냅샷, 체크섬 지원
* **ZFS**: 풀 스토리지, 스냅샷, RAID-Z 지원
* **F2FS**: 플래시 메모리 최적화 파일시스템

마운트 예시:

```bash
mount /dev/sdb1 /data
```

이 명령은 `/dev/sdb1` 블록 디바이스를 `/data` 디렉터리에 연결합니다.

---

## 5. 파티션, LVM, RAID

### 5.1 파티션

* MBR: 최대 2TB, 4개의 주 파티션
* GPT: 2TB 초과 지원, 파티션 무제한에 가까움

### 5.2 LVM (Logical Volume Manager)

* 물리 볼륨(PV) → 볼륨 그룹(VG) → 논리 볼륨(LV)
* 디스크를 묶어 가상 스토리지 풀을 만들고 유연한 용량 관리 제공

### 5.3 RAID

* RAID 0: 성능 향상
* RAID 1: 미러링(복제)
* RAID 5/6: 스트라이핑 + 패리티 → 성능 + 안정성

---

## 6. 디바이스 매핑과 영속성

* **udev**: `/dev/sd*` 같은 장치 노드를 자동 생성
* `/dev/disk/by-uuid/`, `/dev/disk/by-id/` 링크 제공 → UUID 기반 영속적 식별

예:

```bash
/dev/disk/by-uuid/1234-ABCD -> ../../sda1
```

---

## 7. 스토리지 관리 도구

| 명령어      | 역할              |
| -------- | --------------- |
| `lsblk`  | 블록 디바이스 구조 보기   |
| `blkid`  | UUID, 파티션 정보 보기 |
| `fdisk`  | MBR 파티션 관리      |
| `parted` | GPT 파티션 관리      |
| `lvm`    | LVM 관리          |
| `mdadm`  | 소프트웨어 RAID 관리   |
| `mkfs`   | 파일시스템 생성        |

---

## 8. NVMe 기반 저장 장치

* NVMe SSD는 **PCIe 기반 고성능 스토리지**이며 SCSI 계층을 거치지 않음
* 이름 규칙: `/dev/nvme0n1`

  * `nvme0`: 첫 번째 NVMe 컨트롤러
  * `n1`: 첫 번째 네임스페이스(namespace)

---

## 9. 리눅스 스토리지 전체 아키텍처 요약

```
[ Application ]  →  open(), read(), write()
       ↓
[ VFS & FS ]     →  ext4, xfs, btrfs
       ↓
[ Block Layer ]  →  I/O 스케줄러, blk-mq
       ↓
[ Device Mapper ]→  LVM, RAID, dm-crypt
       ↓
[ Driver Layer ] →  SCSI, NVMe, AHCI
       ↓
[ Hardware ]     →  HDD, SSD, NVMe, USB, SAN
```

