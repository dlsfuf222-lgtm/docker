

# 🗂️ /etc/hosts: 로컬 호스트명 해석의 시작점

리눅스에서 어떤 도메인 이름(`example.com`)을 IP 주소로 바꾸려면 보통 DNS 서버를 사용합니다.
하지만 DNS 질의 전에 먼저 참조하는 파일이 바로 **`/etc/hosts`** 입니다.
즉, 이 파일은 **호스트명 → IP 주소 매핑을 로컬에서 직접 정의**하는 역할을 합니다.

---

## 🧠 1. 주요 역할

1. **로컬 호스트명 해석(Local Name Resolution)**

   * DNS에 질의하기 전에 이 파일을 먼저 확인합니다.
   * 등록된 이름이 있으면 DNS를 거치지 않고 바로 IP 주소를 반환합니다.

2. **고정 매핑(Static Mapping)**

   * IP 주소와 호스트명을 수동으로 지정해 테스트 환경이나 사설 네트워크에서 유용하게 사용됩니다.

3. **DNS 장애 대비**

   * DNS 서버 장애 시에도 중요한 서버의 IP를 미리 정의해두면 문제 없이 접근할 수 있습니다.

---

## 🛠 2. 기본 구조

```conf
127.0.0.1   localhost
127.0.1.1   myhost
192.168.1.10 webserver
10.0.0.5    db.internal.local db
```

| 컬럼            | 의미                              |
| ------------- | ------------------------------- |
| **IP 주소**     | 호스트명과 매핑될 IP 주소                 |
| **호스트명**      | 주 호스트명(FQDN일 수도 있고 아닐 수도 있음)    |
| **별칭(alias)** | 같은 IP에 대한 추가 이름(공백으로 구분, 선택 사항) |

---

## 📍 3. /etc/hosts vs DNS

| 비교 항목 | /etc/hosts        | DNS 서버             |
| ----- | ----------------- | ------------------ |
| 관리 방식 | 수동 관리             | 중앙 집중식, 자동 업데이트 가능 |
| 적용 범위 | 로컬 머신 한정          | 전 세계 네트워크          |
| 해석 속도 | 매우 빠름 (파일만 읽으면 됨) | 네트워크 요청 필요         |
| 유연성   | 낮음 (파일 수정해야 함)    | 높음 (레코드 추가/삭제 가능)  |

---

## 🐳 4. Docker 컨테이너 안의 /etc/hosts

Docker는 컨테이너를 시작할 때 **자동으로 /etc/hosts를 채워줍니다**:

```bash
$ docker run --rm alpine cat /etc/hosts
127.0.0.1       localhost
::1             localhost ip6-localhost ip6-loopback
172.17.0.2      123abc456def   # 컨테이너 ID → IP 매핑
```

* 컨테이너 자신의 IP와 호스트명(`--hostname` 옵션)도 자동 등록됩니다.
* 그래서 `ping <호스트명>`은 잘 되지만, `nslookup <호스트명>`은 안 되는 이유가 **/etc/hosts는 DNS가 아니라 로컬 파일이기 때문**입니다.

---

## ⚡ 5. 요약

| 항목            | 설명                                     |
| ------------- | -------------------------------------- |
| **위치**        | `/etc/hosts`                           |
| **역할**        | 로컬에서 호스트명 ↔ IP 주소 매핑                   |
| **Docker 연동** | 컨테이너 시작 시 자동 생성, `--add-host`로 추가 가능   |
| **DNS와 차이**   | /etc/hosts는 로컬 전용, DNS는 네트워크 전역적 이름 해석 |

---

