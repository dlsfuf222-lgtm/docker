우분투(Ubuntu)나 대부분의 리눅스 시스템에서 **`sudo`(superuser do)** 는 **일반 사용자가 관리자(root) 권한이 필요한 명령을 안전하게 실행**할 수 있게 해주는 핵심 도구입니다. 특히 우분투는 기본적으로 root 계정 로그인 대신 `sudo`를 통한 권한 상승을 권장합니다.


---

## 1. `sudo`의 기본 개념

* **정의:**
  `sudo`는 특정 명령을 **슈퍼유저(root)** 또는 다른 사용자 권한으로 실행할 수 있게 해주는 명령어입니다.
* **목적:**
  관리자 권한이 필요한 명령 실행 시 매번 root 계정으로 로그인하지 않고, **필요할 때만 권한 상승**을 할 수 있도록 보안성을 강화합니다.

---

## 2. 기본 사용법

```bash
sudo <명령어>
```

예시:

```bash
sudo apt update
sudo apt install nginx
```

→ 시스템 패키지를 업데이트하고 Nginx 웹서버를 설치합니다.

---

## 3. 주요 옵션

| 옵션         | 설명                               | 예시                          |
| ---------- | -------------------------------- | --------------------------- |
| `-u <사용자>` | 다른 사용자로 명령 실행                    | `sudo -u postgres psql`     |
| `-i`       | root 계정의 로그인 쉘 환경을 실행            | `sudo -i`                   |
| `-s`       | root 계정의 쉘 실행                    | `sudo -s`                   |
| `-k`       | 인증 캐시 삭제 (다시 비밀번호 입력 필요)         | `sudo -k`                   |
| `-l`       | 현재 사용자에게 허용된 명령 목록 보기            | `sudo -l`                   |
| `-v`       | sudo 세션의 인증 시간 연장                | `sudo -v`                   |
| `-H`       | 홈 디렉토리를 root 계정의 홈(`~root`)으로 지정 | `sudo -H pip install flask` |

---

## 4. `sudo` 인증과 보안 동작 방식

1. 사용자가 `sudo` 실행 → 시스템은 `/etc/sudoers` 파일을 참조
2. 사용자에게 비밀번호 입력 요청 → **인증 성공 시** 일정 시간(기본 15분) 동안 재입력 불필요
3. 명령 실행 시 root 권한으로 해당 명령을 실행

> 우분투에서는 기본적으로 `sudo` 그룹(`sudoers`)에 속한 사용자만 `sudo` 사용 가능

---

## 5. `sudoers` 설정

`sudoers` 파일은 `visudo` 명령으로 수정합니다.

```bash
sudo visudo
```

예:

```
user1   ALL=(ALL:ALL) ALL
```

→ `user1`은 모든 호스트, 모든 사용자 권한으로 모든 명령 실행 가능

---

## 6. 고급 사용 예시

### (1) 특정 사용자 권한으로 명령 실행

```bash
sudo -u www-data whoami
```

출력: `www-data`

---

### (2) 루트 쉘 진입

```bash
sudo -i
```

혹은

```bash
sudo -s
```

---

### (3) `sudo` 세션 즉시 종료

```bash
sudo -k
```

→ 다음 sudo 명령 시 비밀번호 재입력 필요

---

## 7. `sudo` vs `su` vs `runuser` 비교

| 명령어       | 권한 획득 방식    | 비밀번호 입력 대상     | 사용 예                          |
| --------- | ----------- | -------------- | ----------------------------- |
| `sudo`    | 명령 단위 권한 상승 | **자신의 비밀번호**   | `sudo apt update`             |
| `su`      | 로그인 쉘 전환    | **타 사용자 비밀번호** | `su - postgres`               |
| `runuser` | 명령 단위 전환    | 인증 생략 가능       | `runuser -u postgres -- psql` |

---

## 8. 요약

* 우분투는 root 계정 비활성화 상태에서 **`sudo` 기반 권한 관리**를 사용
* `sudo -u`를 활용하면 다른 사용자 권한으로도 실행 가능
* `/etc/sudoers`로 세밀한 권한 제어 가능


---
`apt update`와 `apt upgrade`는 패키지 관리에서 서로 다른 역할을 수행하는 별개의 명령어입니다. 

---

### `apt update` 🔄

**`apt update`** 는 시스템의 로컬 패키지 **목록**을 최신화하는 명령어입니다. 이 명령어는 인터넷에 연결된 소프트웨어 저장소(리포지토리)에서 사용 가능한 패키지들의 최신 정보를 가져와서, 내 컴퓨터에 있는 패키지 목록 데이터베이스를 업데이트합니다. 이 과정은 새로운 패키지가 추가되었거나, 기존 패키지가 새로운 버전으로 업데이트되었다는 **정보**만 가져올 뿐, 실제 패키지 파일을 다운로드하거나 설치하지는 않습니다. 

쉽게 말해, `apt update`는 **상점의 최신 카탈로그를 확인**하는 것과 같습니다.  어떤 물건이 새로 들어왔고, 가격이 바뀌었는지 등을 알아보는 것이죠.

---

### `apt upgrade` 🚀

**`apt upgrade`** 는 로컬 패키지 목록을 기반으로 **실제로 설치된 패키지들을 최신 버전으로 업그레이드**하는 명령어입니다. 이 명령어는 `apt update`를 통해 최신화된 목록을 참고하여, 현재 시스템에 설치된 패키지들 중에서 업그레이드가 필요한 패키지들을 찾고, 해당 패키지들의 최신 버전을 다운로드하여 설치합니다.

이 명령어는 **카탈로그를 보고 실제 물건을 구매**하는 것에 비유할 수 있습니다. `apt update`로 최신 정보를 파악한 후, `apt upgrade`를 통해 내가 가진 물건들을 최신 버전으로 교체하는 것입니다.

### 요약하자면,

* **`apt update`**: **최신 패키지 정보를 가져오는 것** (목록 갱신)
* **`apt upgrade`**: **실제 패키지를 최신 버전으로 교체하는 것** (설치 및 업그레이드)

두 명령어는 함께 사용되어야만 효과적입니다. 일반적으로, 새로운 패키지를 설치하거나 모든 패키지를 최신 상태로 유지하고 싶을 때는 `sudo apt update && sudo apt upgrade`와 같이 두 명령어를 연달아 실행하는 것이 권장됩니다.

